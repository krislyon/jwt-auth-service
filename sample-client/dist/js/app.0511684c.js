(function(e){function t(t){for(var o,c,s=t[0],a=t[1],l=t[2],b=0,p=[];b<s.length;b++)c=s[b],Object.prototype.hasOwnProperty.call(r,c)&&r[c]&&p.push(r[c][0]),r[c]=0;for(o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o]);i&&i(t);while(p.length)p.shift()();return u.push.apply(u,l||[]),n()}function n(){for(var e,t=0;t<u.length;t++){for(var n=u[t],o=!0,s=1;s<n.length;s++){var a=n[s];0!==r[a]&&(o=!1)}o&&(u.splice(t--,1),e=c(c.s=n[0]))}return e}var o={},r={app:0},u=[];function c(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=o,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)c.d(n,o,function(t){return e[t]}.bind(null,o));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],a=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var i=a;u.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},1:function(e,t){},10:function(e,t){},11:function(e,t){},12:function(e,t){},13:function(e,t){},14:function(e,t){},2:function(e,t){},3:function(e,t){},"3f49":function(e,t,n){"use strict";n("705e")},4:function(e,t){},5:function(e,t){},"56d7":function(e,t,n){"use strict";n.r(t);var o=n("7a23");function r(e,t,n,r,u,c){const s=Object(o["u"])("Navbar"),a=Object(o["u"])("router-view");return Object(o["p"])(),Object(o["d"])(o["a"],null,[Object(o["g"])(s),Object(o["g"])(a)],64)}const u={id:"nav"},c=Object(o["f"])("Home"),s={key:0},a=Object(o["f"])(" | "),l=Object(o["f"])("User Details"),i=Object(o["f"])(" | "),b={key:1},p=Object(o["f"])(" | "),d=Object(o["f"])("Login");function O(e,t,n,r,O,j){const g=Object(o["u"])("router-link");return Object(o["p"])(),Object(o["d"])("nav",null,[Object(o["g"])("div",u,[Object(o["g"])(g,{to:"/"},{default:Object(o["A"])(()=>[c]),_:1}),r.userState.loggedIn?(Object(o["p"])(),Object(o["d"])("span",s,[a,Object(o["g"])(g,{to:"/details"},{default:Object(o["A"])(()=>[l]),_:1}),i,Object(o["g"])("a",{href:"",onClick:t[1]||(t[1]=Object(o["C"])((...e)=>r.handleSignOut&&r.handleSignOut(...e),["prevent"]))},"Logout")])):(Object(o["p"])(),Object(o["d"])("span",b,[p,Object(o["g"])(g,{to:"/login"},{default:Object(o["A"])(()=>[d]),_:1})]))])])}var j=n("1232"),g=n("bc3a"),f=n.n(g);const h=()=>{const e={baseURL:"https://localhost:3000",withCredentials:!0,json:!0,headers:{"Content-Type":"application/json"}};let t=f.a.create(e);return t.interceptors.request.use((function(e){const t=R();return""!=t.authToken&&(e.headers.Authorization="Bearer "+t.authToken),e})),t.interceptors.response.use(e=>e,async e=>{var n=R();const o=e.config;return 401!==e.response.status||o._retry||"/refresh"===o.url?(401===e.response.status&&"/refresh"===o.url&&n.logout(),e):(o._retry=!0,t.post("/refresh").then(e=>e&&200===e.status?(n.refresh(e.data.auth_token),t(o)):e.response))}),t};var v=h(),y="";const m=Object(o["t"])({}),w=async()=>{if(""==y){const e=await v.post("/refresh").then(e=>{e&&200===e.status&&P(e.data.auth_token)});return e}};w();const S=(e,t)=>{const n={...e,loggedIn:!0,jwt:{...Object(j["a"])(t)}};m.value=n,y=t},k=()=>{""!==y&&(console.debug("User signed out."),y=""),m.value={}},P=e=>{const t={loggedIn:!0,jwt:{...Object(j["a"])(e)}};m.value=t,y=e,console.debug("Auth Token updated.")},R=()=>({state:Object(o["s"])(m),authToken:y,login:S,logout:k,refresh:P});var T={setup(){const e=R(),t=e.state,n=async()=>{const e=R();if(e.state.value.loggedIn){let t=await v.post("/logout",{userId:e.state.value.jwt.userId});if(200!=t.status)return void console.log("Failed to retrieve salt");e.logout()}};return{handleSignOut:n,userState:t}}};T.render=O;var _=T,L={components:{Navbar:_},setup(){}};n("90b8");L.render=r;var I=L,C=n("6c02");const q=Object(o["g"])("h2",null,"JWT Auth Sample",-1);function x(e,t,n,r,u,c){return Object(o["p"])(),Object(o["d"])("div",null,[q,Object(o["g"])("button",{type:"button",onClick:t[1]||(t[1]=Object(o["C"])((...e)=>r.handleRequestPublicResource&&r.handleRequestPublicResource(...e),["prevent"]))},"Request Public Resource"),Object(o["g"])("button",{type:"button",onClick:t[2]||(t[2]=Object(o["C"])((...e)=>r.handleRequestProtectedResource&&r.handleRequestProtectedResource(...e),["prevent"]))},"Request Protected Resource"),Object(o["g"])("p",null,"Auth Status: "+Object(o["w"])(r.authStatus),1),Object(o["g"])("p",null,Object(o["w"])(r.responseStatus),1),Object(o["g"])("p",null,Object(o["w"])(r.responseData),1)])}var A={name:"Home",components:{},setup(){const e=R(),t=Object(o["t"])(""),n=Object(o["t"])(""),r=Object(o["t"])(""),u=Object(o["b"])(()=>e.state.value.loggedIn?{status:"Logged In"}:{status:"Logged Out"}),c=e=>{r.value=e.data,n.value=e.headers,t.value=`HTTP ${e.status} - ${e.statusText}`},s=async()=>{v.get("/protected").then(e=>{c(e)}).catch(e=>{c(e.response)})},a=async()=>{v.get("/public").then(e=>{c(e)}).catch(e=>{c(e.response)})};return{handleRequestProtectedResource:s,handleRequestPublicResource:a,authStatus:u,responseData:r,responseHeaders:n,responseStatus:t}}};A.render=x;var U=A;const H=Object(o["g"])("h2",null,"Please Log In",-1),D=Object(o["g"])("label",null,"Username: ",-1),M=Object(o["g"])("label",null,"Password: ",-1);function B(e,t,n,r,u,c){return Object(o["p"])(),Object(o["d"])("div",null,[H,Object(o["g"])("form",null,[D,Object(o["B"])(Object(o["g"])("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>r.username=e)},null,512),[[o["y"],r.username]]),M,Object(o["B"])(Object(o["g"])("input",{type:"password","onUpdate:modelValue":t[2]||(t[2]=e=>r.password=e)},null,512),[[o["y"],r.password]]),Object(o["g"])("button",{type:"button",onClick:t[3]||(t[3]=Object(o["C"])((...e)=>r.performLogin&&r.performLogin(...e),["prevent"]))},"Sign in")])])}var F=n("1c46"),J=n.n(F),V={setup(){const e=Object(o["t"])(""),t=Object(o["t"])(""),n=async()=>{try{let o=e.value,r=await v.post("/login",{userId:o});if(200!=r.status)return void console.log("Failed to retrieve salt");const u=J.a.createHash("sha256");u.update(r.data.salt+t.value);const c=u.digest().toString("hex");if(r=await v.post("/login",{pwHash:c,userId:o}),200!=r.status)return void console.log("Failed to log in.");var n=R();n.login({sampledata:"test"},r.data.auth_token),console.log("Logged In."),n=R()}catch(o){console.log(o)}};return{username:e,password:t,performLogin:n}}};V.render=B;var N=V;const $={key:0},z={class:"authPropsTable"},W=Object(o["g"])("tr",null,[Object(o["g"])("th",null,"Property"),Object(o["g"])("th",null,"Value")],-1),E=Object(o["g"])("td",null,"Auth Token",-1),G=Object(o["g"])("td",null,"Refresh Token",-1),K=Object(o["g"])("td",null,"userState",-1);function Q(e,t,n,r,u,c){return Object(o["p"])(),Object(o["d"])(o["a"],null,[r.userState.photoURL?(Object(o["p"])(),Object(o["d"])("div",$,[Object(o["g"])("img",{src:r.userState.photoURL},null,8,["src"])])):Object(o["e"])("",!0),Object(o["g"])("div",null,[Object(o["g"])("table",z,[W,Object(o["g"])("tr",null,[E,Object(o["g"])("td",null,Object(o["w"])(r.userState.token),1)]),Object(o["g"])("tr",null,[G,Object(o["g"])("td",null,Object(o["w"])(r.userState.refreshToken),1)]),Object(o["g"])("tr",null,[K,Object(o["g"])("td",null,Object(o["w"])(r.userState),1)])])])],64)}var X={setup(){const e=R(),t=e.state;return{userState:t}}};n("3f49");X.render=Q;var Y=X;const Z=[{path:"/",name:"Home",component:U},{path:"/login",name:"Login",component:N},{path:"/details",name:"Details",component:Y}],ee=Object(C["a"])({history:Object(C["b"])("/"),routes:Z});var te=ee;Object(o["c"])(I).use(te).mount("#app")},6:function(e,t){},7:function(e,t){},"705e":function(e,t,n){},8:function(e,t){},9:function(e,t){},"90b8":function(e,t,n){"use strict";n("f85a")},f85a:function(e,t,n){}});
//# sourceMappingURL=app.0511684c.js.map